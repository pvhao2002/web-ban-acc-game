@model BShop.Models.ViewModel.ProfileViewModel

@{
    ViewBag.Title = "Trang cá nhân";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


@Html.Partial("_Breadcrumb")

<!-- Content Section -->
<div class="container content-space-1 content-space-t-lg-0 content-space-b-lg-2 mt-lg-n10">
    <div class="row">
        <div class="col-lg-3">
            <!-- Navbar -->
            @Html.Partial("Sidebar")
            <!-- End Navbar -->
        </div>
        <!-- End Col -->

        <div class="col-lg-9">
            <div class="d-grid gap-3 gap-lg-5">
                <!-- Card -->
                <div class="card">
                    <div class="card-header border-bottom">
                        <h4 class="card-header-title">Thông tin cơ bản</h4>
                    </div>

                    <!-- Body -->
                    <div class="card-body">
                        <form class="js-validate-3 need-validate" novalidate action="/Profile/Update" method="post">
                            <!-- Form -->
                            <div class="row mb-4 d-none">
                                <label class="col-sm-3 col-form-label form-label">Profile photo</label>

                                <div class="col-sm-9">
                                    <!-- Media -->
                                    <div class="d-flex align-items-center">
                                        <!-- Avatar -->
                                        <label class="avatar avatar-xl avatar-circle" for="avatarUploader">
                                            <img id="avatarImg" class="avatar-img" src="" alt="Image Description">
                                        </label>

                                        <div class="d-grid d-sm-flex gap-2 ms-4">
                                            <div class="form-attachment-btn btn btn-primary btn-sm">
                                                Upload photo
                                                <input type="file" class="js-file-attach form-attachment-btn-label" id="avatarUploader" data-hs-file-attach-options='{
                                      "textTarget": "#avatarImg",
                                      "mode": "image",
                                      "targetAttr": "src",
                                      "resetTarget": ".js-file-attach-reset-img",
                                      "resetImg": "./assets/img/160x160/img1.jpg",
                                      "allowTypes": [".png", ".jpeg", ".jpg"]
                                   }'>
                                            </div>
                                            <!-- End Avatar -->

                                            <button type="button" class="js-file-attach-reset-img btn btn-white btn-sm">Delete</button>
                                        </div>
                                    </div>
                                    <!-- End Media -->
                                </div>
                            </div>
                            <!-- End Form -->

                            <!-- Form -->
                            <div class="row mb-4">
                                <label for="fullNameLabel" class="col-sm-3 col-form-label form-label">Họ và tên <i class="bi-question-circle text-body ms-1" data-bs-toggle="tooltip" data-bs-placement="top" title="Displayed on public forums, such as Front."></i></label>

                                <div class="col-sm-9">
                                    <div class="input-group">
                                        <input type="text" class="form-control"
                                               name="fullName" id="fullNameLabel"
                                               placeholder="Họ và tên"
                                               required="required"
                                               aria-label="@Model.u.FullName"
                                               value="@Model.u.FullName">
                                    </div>
                                </div>
                            </div>
                            <!-- End Form -->

                            <!-- Form -->
                            <div class="row mb-4">
                                <label for="passwordLabel" class="col-sm-3 col-form-label form-label">Mật khẩu</label>
                                <div class="col-sm-9">
                                    <input type="password" class="form-control" name="password"
                                           id="passwordLabel" placeholder="********"
                                           aria-label="@Model.u.Password" value="@Model.u.Password" minlength="8">
                                </div>
                                <span class="invalid-feedback">Mật khẩu không đủ 8 ký tự.</span>
                            </div>

                            <div class="row mb-4">
                                <label for="emailLabel" class="col-sm-3 col-form-label form-label">Email</label>
                                <div class="col-sm-9">
                                    <input type="email" readonly="readonly" class="form-control" name="email"
                                           id="emailLabel" placeholder="example@gmail.com"
                                           aria-label="@Model.u.Email" value="@Model.u.Email">
                                </div>
                            </div>

                            <div class="row mb-4">
                                <label for="createLabel" class="col-sm-3 col-form-label form-label">Ngày tạo tài khoản</label>
                                <div class="col-sm-9">
                                    <input type="text" disabled="disabled" class="form-control" name="createAt"
                                           id="createLabel"
                                           placeholder="01-01-1900"
                                           aria-label="@Model.u.CreatedAt"
                                           value="@Model.u.CreatedAt">
                                </div>
                            </div>

                            <div class="row mb-4">
                                <label for="updateLabel" class="col-sm-3 col-form-label form-label">Lần cập nhật gần nhất</label>
                                <div class="col-sm-9">
                                    <input type="text" disabled="disabled" class="form-control" name="updateAt"
                                           id="updateLabel"
                                           placeholder="01-01-1900"
                                           aria-label="@Model.u.UpdatedAt"
                                           value="@Model.u.UpdatedAt">
                                </div>
                            </div>
                            <!-- End Form -->
                            <div class="d-flex justify-content-end gap-3">
                                <button type="submit" class="btn btn-primary form-control-lg">Cập nhật thông tin</button>
                            </div>
                        </form>
                    </div>
                    <!-- End Body -->
                    <!-- Footer -->
                    <div class="card-footer pt-0">

                    </div>
                    <!-- End Footer -->
                </div>
                <!-- End Card -->
                <!-- Card -->
                <div class="card d-none">
                    <div class="card-header border-bottom">
                        <h4 class="card-header-title">Delete your account</h4>
                    </div>

                    <!-- Body -->
                    <div class="card-body">
                        <p class="card-text">When you delete your account, you lose access to Front account services, and we permanently delete your personal data. You can cancel the deletion for 14 days.</p>

                        <div class="mb-4">
                            <!-- Check -->
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="deleteAccountCheckbox">
                                <label class="form-check-label" for="deleteAccountCheckbox">Confirm that I want to delete my account.</label>
                            </div>
                            <!-- End Check -->
                        </div>

                        <div class="d-flex justify-content-end">
                            <button type="submit" class="btn btn-danger">Delete</button>
                        </div>
                    </div>
                    <!-- End Body -->
                </div>
                <!-- End Card -->
            </div>
        </div>
    </div>
    <!-- End Row -->
</div>
<!-- End Content Section -->

@section js {
    <script>
    (function() {
        // INITIALIZATION OF BOOTSTRAP VALIDATION
        // =======================================================
        HSBsValidation.init('.js-validate-3', {
            onSubmit: data => {
                data.event.preventDefault();
                data.event.stopPropagation();
                // get form data
                const dataForm = new FormData(data.form);
                // get form action
                const action = data.form.getAttribute('action');
                // send form data
                fetch(action, {
                    method: 'POST',
                    body: dataForm
                }).then(response => {
                    if (response.ok) {
                        return response.json();
                    }
                    showAlert('Something went wrong', 'danger');
                    throw new Error('Something went wrong');
                }).then(rs => {
                    if (rs.success) {
                        showAlert('Cập nhật thông tin thành công', 'success');
                    } else {
                        showAlert(rs.message, 'danger');
                    }
                }).catch(error => {
                    showAlert('Cập nhật thông tin thất bại', 'danger');
                });
            }
        })
    })();
</script>
}